# How to upgrade a repl to unrepl 

(Audience: repl client authors)

Once you have a connection to a REPL, you send the content of the resource file `unrepl/blob.clj` to it
(the file is not present in the repository but should be present in the artifact, it's generated by
`lein unrepl-make-blob`).

Here is how you could get an unrepl from your CLI:

```
lein unrepl-make-blob
rlwrap cat resources/unrepl/blob.clj - | nc localhost 5555
```

Either you get `[:unrepl.upgrade/failed]` or `[:unrepl/hello ...]` on the repl output. Upon failure you are back in the repl you started from.

Each use of the blob creates gensymed namespaces.

You can customize the blob: enter `lein unrepl-make-blob <target-file> <session actions map>`. Where the session actions map can be either a string or a `.edn` file. For example:

```
# As a string
$> lein unrepl-make-blob foo-blob.clj '{:my.own/action (foo/bar #unrepl/param :baz)}'
# As a file
$> lein unrepl-make-blob foo-blob.clj custom-actions.edn
```

If a custom action has a qualified symbol as the first element (function symbol) for its topmost form, this qualified symbol's namespace will automatically be required on the first use of the action.
